#!/bin/bash
BASEDIR=$(dirname "$0")

# Delete any tables in our nodes that are named ORDERS.
sqlite3 $BASEDIR/../data/node1.db 'BEGIN TRANSACTION; DROP TABLE IF EXISTS ORDERS; COMMIT;'
sqlite3 $BASEDIR/../data/node2.db 'BEGIN TRANSACTION; DROP TABLE IF EXISTS ORDERS; COMMIT;'
sqlite3 $BASEDIR/../data/node3.db 'BEGIN TRANSACTION; DROP TABLE IF EXISTS ORDERS; COMMIT;'

# Also, delete any entries from our catalog node where tname is ORDERS.
if [ $(sqlite3 $BASEDIR/../data/catalog.db 'SELECT 1 FROM sqlite_master WHERE type="table" AND
    name="dtables";) -eq '1' ] then
    sqlite3 $BASEDIR/../data/catalog.db 'BEGIN TRANSACTION; DELETE FROM dtables WHERE
        tname="ORDERS";'
fi
